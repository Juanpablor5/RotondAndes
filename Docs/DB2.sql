DROP TABLE Espacio;
DROP TABLE IngredienteSimilitud;
DROP TABLE Preferencias;
DROP TABLE Reserva;
DROP TABLE Representante;
DROP TABLE Categoria;
DROP TABLE Pedido_Menu;
DROP TABLE Menu;
DROP TABLE Restaurante;
DROP TABLE Pedido;
DROP TABLE Cliente;
DROP TABLE Usuario;
DROP TABLE TipoComida;
DROP TABLE Producto_Ingrediente;
DROP TABLE Ingrediente;
DROP TABLE Producto;
DROP TABLE Zona;


CREATE TABLE Zona(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nombre VARCHAR2(100) NOT NULL,
CHECK (nombre <> ''),
CONSTRAINT PK_Zona PRIMARY KEY ( id )
);

CREATE TABLE Producto(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nombre VARCHAR2(100) NOT NULL,
CHECK (nombre <> ''),
descripcion VARCHAR2(1000) NOT NULL,
CHECK (descripcion <> ''),
traduccion VARCHAR2(1200) NOT NULL,
CHECK (traduccion <> ''),
tiempoPreparacion INTEGER NOT NULL,
CHECK (tiempoPreparacion > 0),
categoria VARCHAR2(100) NOT NULL,
CONSTRAINT PK_Producto PRIMARY KEY ( id )
);

CREATE TABLE Ingrediente(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nombre VARCHAR2(100) NOT NULL,
descripcion VARCHAR2(1000) NOT NULL,
traduccion VARCHAR2(1200) NOT NULL,
CONSTRAINT PK_Ingrediente PRIMARY KEY ( id )
);

CREATE TABLE Producto_Ingrediente(
ingredientes_id INTEGER NOT NULL,
CONSTRAINT FK_Producto_Ingrediente FOREIGN KEY ( ingredientes_id ) REFERENCES  Producto( id ),
productos_id INTEGER NOT NULL,
CONSTRAINT FK_Producto_Ingrediente2 FOREIGN KEY ( productos_id ) REFERENCES  Ingrediente( id ),
CONSTRAINT PK_Producto_Ingrediente PRIMARY KEY ( ingredientes_id , productos_id )
);

CREATE TABLE TipoComida(
nombre VARCHAR2(100) NOT NULL,
CONSTRAINT PK_TipoComida PRIMARY KEY ( nombre )
);

CREATE TABLE Usuario(
codigo INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nickName VARCHAR2(100) NOT NULL UNIQUE,
CHECK (nickName <> ''),
contrasenia VARCHAR2(100) NOT NULL,
CHECK (contrasenia <> ''),
correo VARCHAR2(100) NOT NULL,
CHECK (correo <> ''),
permisos INTEGER NOT NULL,
CHECK (permisos BETWEEN 0 AND 3),
CONSTRAINT PK_Usuario PRIMARY KEY ( codigo )
);

CREATE TABLE Cliente(
cedula INTEGER NOT NULL,
nombre VARCHAR2(100) NOT NULL,
CHECK (nombre <> ''),
fechaIngreso DATE DEFAULT SYSDATE NOT NULL,
registro_codigo INTEGER NOT NULL,
CONSTRAINT FK_Cliente1 FOREIGN KEY ( registro_codigo ) REFERENCES Usuario( codigo ),
CONSTRAINT FK_Cliente1_U UNIQUE ( registro_codigo ),
CONSTRAINT PK_Cliente PRIMARY KEY ( cedula )
);

CREATE TABLE Pedido(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
fechahora VARCHAR2(100) DEFAULT SYSDATE NOT NULL,
cliente_cedula INTEGER NOT NULL,
CONSTRAINT FK_Pedido1 FOREIGN KEY ( cliente_cedula ) REFERENCES Cliente( cedula ),
CONSTRAINT PK_Pedido PRIMARY KEY ( id )
);

CREATE TABLE Restaurante(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nombre VARCHAR2(100) NOT NULL,
CHECK (nombre <> ''),
paginaWeb VARCHAR2(100),
CHECK (paginaWeb <> ''),
registro_codigo INTEGER NOT NULL,
CONSTRAINT FK_Restaurante1 FOREIGN KEY ( registro_codigo ) REFERENCES Usuario( codigo ),
CONSTRAINT FK_Restaurante1_U UNIQUE ( registro_codigo ),
tipoComida_nombre VARCHAR2(100),
CONSTRAINT FK_Restaurante2 FOREIGN KEY ( tipoComida_nombre ) REFERENCES TipoComida( nombre ),
CONSTRAINT PK_Restaurante PRIMARY KEY ( id )
);

CREATE TABLE Menu(
id INTEGER NOT NULL,
cantidad INTEGER NOT NULL,
CHECK (cantidad > 0),
costoProduccion NUMBER NOT NULL,
CHECK (costoProduccion > 0),
valorAlPublico NUMBER NOT NULL,
CHECK (valorAlPublico > 0),
productoEntrada_id INTEGER NOT NULL,
CONSTRAINT FK_Menu1 FOREIGN KEY ( productoEntrada_id ) REFERENCES Producto( id ),
productoFuerte_id INTEGER NOT NULL,
CONSTRAINT FK_Menu2 FOREIGN KEY ( productoFuerte_id ) REFERENCES Producto( id ),
productoBebida_id INTEGER NOT NULL,
CONSTRAINT FK_Menu3 FOREIGN KEY ( productoBebida_id ) REFERENCES Producto( id ),
productoPostre_id INTEGER NOT NULL,
CONSTRAINT FK_Menu4 FOREIGN KEY ( productoPostre_id ) REFERENCES Producto( id ),
productoAcompanamiento_id INTEGER NOT NULL,
CONSTRAINT FK_Menu5 FOREIGN KEY ( productoAcompanamiento_id ) REFERENCES Producto( id ),
restaurante_id INTEGER NOT NULL,
CONSTRAINT FK_Menu6 FOREIGN KEY ( restaurante_id ) REFERENCES Restaurante( id ),
CONSTRAINT PK_Menu PRIMARY KEY ( id )
);

CREATE TABLE Pedido_Menu(
pedidos_id INTEGER NOT NULL,
CONSTRAINT FK_Pedido_Menu FOREIGN KEY ( pedidos_id ) REFERENCES  Pedido( id ),
Menus_id INTEGER NOT NULL,
CONSTRAINT FK_Pedido_Menu2 FOREIGN KEY ( Menus_id ) REFERENCES  Menu( id ),
CONSTRAINT PK_Pedido_Menu PRIMARY KEY ( pedidos_id , Menus_id )
);

CREATE TABLE Categoria(
id INTEGER NOT NULL,
nombre VARCHAR2(100) NOT NULL UNIQUE,
CONSTRAINT PK_Categoria PRIMARY KEY ( id )
);

CREATE TABLE Representante(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
nombre VARCHAR2(100) NOT NULL,
CHECK (nombre <> ''),
telefono INTEGER NOT NULL,
CHECK (telefono > 0),
correo VARCHAR2(100) NOT NULL,
CHECK (correo <> ''),
restaurante_id INTEGER NOT NULL,
CONSTRAINT FK_Representante1 FOREIGN KEY ( restaurante_id ) REFERENCES Restaurante( id ),
CONSTRAINT FK_Representante1_U UNIQUE ( restaurante_id ),
CONSTRAINT PK_Representante PRIMARY KEY ( id )
);

CREATE TABLE Reserva(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
fechahora VARCHAR2(100) DEFAULT SYSDATE NOT NULL,
duracion INTEGER NOT NULL,
CHECK (duracion > 0),
comensales INTEGER NOT NULL,
CHECK (comensales > 0),
nombreReservante VARCHAR2(100) NOT NULL,
CHECK (nombreReservante <> ''),
telefonoReservante INTEGER NOT NULL,
CHECK (telefonoReservante > 0),
zona_id INTEGER NOT NULL,
CONSTRAINT FK_Reserva1 FOREIGN KEY ( zona_id ) REFERENCES Zona( id ),
menu_id INTEGER NOT NULL,
CONSTRAINT FK_Reserva2 FOREIGN KEY ( menu_id ) REFERENCES Menu( id ),
CONSTRAINT PK_Reserva PRIMARY KEY ( id )
);

CREATE TABLE Preferencias(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
precioMenor NUMBER NOT NULL,
CHECK (precioMenor >= 0),
precioMayor NUMBER NOT NULL,
CHECK (precioMayor >= 0),
cliente_cedula INTEGER NOT NULL,
CONSTRAINT FK_Preferencias1 FOREIGN KEY ( cliente_cedula ) REFERENCES Cliente( cedula ),
CONSTRAINT FK_Preferencias1_U UNIQUE ( cliente_cedula ),
CONSTRAINT PK_Preferencias PRIMARY KEY ( id )
);

CREATE TABLE IngredienteSimilitud(
id INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY,
restaurante_id INTEGER NOT NULL,
CONSTRAINT FK_IngredienteSimilitud1 FOREIGN KEY ( restaurante_id ) REFERENCES Restaurante( id ),
ingrediente_id INTEGER NOT NULL,
CONSTRAINT FK_IngredienteSimilitud2 FOREIGN KEY ( ingrediente_id ) REFERENCES Ingrediente( id ),
ingrediente2_id INTEGER NOT NULL,
CONSTRAINT FK_IngredienteSimilitud3 FOREIGN KEY ( ingrediente2_id ) REFERENCES Ingrediente( id ),
CONSTRAINT PK_IngredienteSimilitud PRIMARY KEY ( id )
);

CREATE TABLE Espacio(
id INTEGER NOT NULL,
acondicionamiento VARCHAR2(500) NOT NULL,
CHECK (acondicionamiento <> ''),
abierto INTEGER NOT NULL,
capacidad INTEGER NOT NULL,
CHECK (capacidad > 0),
necesidadesEspeciales INTEGER NOT NULL,
condicionesTecnicas VARCHAR2(500) NOT NULL,
CHECK (condicionesTecnicas <> ''),
zona_id INTEGER NOT NULL,
CONSTRAINT FK_Espacio1 FOREIGN KEY ( zona_id ) REFERENCES Zona( id ),
CONSTRAINT PK_Espacio PRIMARY KEY ( id )
);

COMMIT;

INSERT INTO TIPOCOMIDA (NOMBRE) VALUES ('indu');
INSERT INTO TIPOCOMIDA (NOMBRE) VALUES ('arabe');
INSERT INTO TIPOCOMIDA (NOMBRE) VALUES ('vegetariana');
INSERT INTO TIPOCOMIDA (NOMBRE) VALUES ('marina');
INSERT INTO TIPOCOMIDA (NOMBRE) VALUES ('rapida');

INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('ADMIN','12345','example@example.com',3);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('RESTAURANTEROCHA','12345','example@example.com',2);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('PIZERRIAALPES','12345','example@example.com',2);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('CAMILO','12345','example@example.com',1);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('JUAN','12345','example@example.com',1);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('ENRIQUE','12345','example@example.com',1);
INSERT INTO USUARIO ( NICKNAME,CONTRASENIA,CORREO,PERMISOS) VALUES ('MARIA','12345','example@example.com',1);

INSERT INTO CLIENTE ( CEDULA,NOMBRE,FECHAINGRESO,REGISTRO_CODIGO) VALUES (1,'camilo','19/05/2000',4);
INSERT INTO CLIENTE ( CEDULA,NOMBRE,FECHAINGRESO,REGISTRO_CODIGO ) VALUES (2,'juan','23/07/2005',5);
INSERT INTO CLIENTE ( CEDULA,NOMBRE,FECHAINGRESO,REGISTRO_CODIGO ) VALUES (3,'enrique','12/08/2007',6);
INSERT INTO CLIENTE ( CEDULA,NOMBRE,FECHAINGRESO,REGISTRO_CODIGO ) VALUES (4,'maria','27/01/2010',7);

INSERT INTO RESTAURANTE (NOMBRE,PAGINAWEB,REGISTRO_CODIGO,TIPOCOMIDA_NOMBRE) VALUES ('pizzeria los alpes','https://pizzeriadelosalpes.wixsite.com/pizzeriadelosalpes',3,'rapida');
INSERT INTO RESTAURANTE (NOMBRE,PAGINAWEB,REGISTRO_CODIGO,TIPOCOMIDA_NOMBRE) VALUES ('la tiendita de rocha','https://que_es_esa_mierda',2,'marina');

INSERT INTO REPRESENTANTE (NOMBRE,TELEFONO,CORREO,RESTAURANTE_ID) VALUES ('rocha',123456,'nomeacuedo@uniandes.edu.co',1);

INSERT INTO INGREDIENTE (NOMBRE,DESCRIPCION,TRADUCCION) VALUES ('AMOR','EL INGREDIENTE MAS IMPORTANTES (VALIDO PARA TODOS LOS PRODUCTS DE ROTONDANTES)','THE MOST IMPORTANT INGREDIENT (VALID FOR ALL ROTONDANTES PRODUCTS)');
INSERT INTO INGREDIENTE (NOMBRE,DESCRIPCION,TRADUCCION) VALUES ('QUESO','ALIMENTO SÓLIDO QUE SE OBTIENE POR MADURACIÓN DE LA CUAJADA DE LA LECHE UNA VEZ ELIMINADO EL SUERO; SUS DIFERENTES VARIEDADES DEPENDEN DEL ORIGEN DE LA LECHE EMPLEADA, DE LOS MÉTODOS DE ELABORACIÓN SEGUIDOS Y DEL GRADO DE MADUREZ ALCANZADO.','SOLID FOOD OBTAINED BY MATURATION OF THE MILK CURD AFTER THE SERUM IS ELIMINATED; ITS VARIOUS VARIANTS DEPEND ON THE ORIGIN OF THE MILK USED, THE METHODS OF PROCESSING FOLLOWED AND THE DEGREE OF MATURITY REACHED.');
INSERT INTO INGREDIENTE (NOMBRE,DESCRIPCION,TRADUCCION) VALUES ('PAPA','TUBERCULO COMESTIBLE DESPUES DE UNA COCCION DETERMINADA','EDIBLE TUBERCULUS AFTER A CERTAIN COOKING.');
INSERT INTO INGREDIENTE (NOMBRE,DESCRIPCION,TRADUCCION) VALUES ('TOMATE','BAYA CASI ROJA, FRUTO DE LA TOMATERA, DE SUPERFICIE LISA Y BRILLANTE, EN CUYA PULPA HAY NUMEROSAS SEMILLAS ALGO APLASTADAS Y AMARILLAS.','ALMOST RED BERRY, FRUIT OF THE TOMATERA, WITH SMOOTH AND SHINY SURFACE, IN WHOSE PULP THERE ARE NUMEROUS SEEDS SOMEWHAT CRUSHED AND YELLOW.');
INSERT INTO INGREDIENTE (NOMBRE,DESCRIPCION,TRADUCCION) VALUES ('POLLO',' ES EL NOMBRE QUE RECIBEN LAS CRÍAS DE LAS GALLINAS Y DE OTRAS AVES.','IS THE NAME GIVEN TO THE OFFSPRING OF HENS AND OTHER BIRDS.');


COMMIT;
